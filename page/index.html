<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fsocket</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"> <!--bootstrap css-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"> <!--bootstrap icons-->
    <link rel="icon" type="image/x-icon" href="/static/fs.ico"> <!--title icon-->
    <link rel="stylesheet" href="/static/style.css"> <!--css-->

    <!--google fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&family=Jua&family=Lilita+One&display=swap" rel="stylesheet">
</head>
<body>
    <h1 class="title">Fsocket</h1>
    <div class="container d-flex justify-content-center mt-3">
        <div class="card text-center " style="width: 30rem; background-color: #070c1b;" >
            <div class="card-body">
                <!--brief-->
                <p class="subtitle">"A Simple Websocket Relay."</p>
                <br>
                <!--connection URL Model-->
                <div class="card" style="background-color: #0b132b;">
                    <div class="card-body" style="color: whitesmoke;">
                        Connection URL<br><code class="code">wss://<span class="domain"></span>/usr/YOUR_ID</code><br>
                                    eg : <code class="code">wss://<span class="domain"></span>/usr/fsock_user1</code>
                    </div>
                </div>
                
                <br><br>
                <!--message format Model-->
                <div class="card" style="background-color: #0b132b;">
                    <div class="card-body" style="color: whitesmoke;">
                    Message Format : <br><code class="code">{"msg_type":"MSG_TYPE","message":"CONTENT","from":"YOUR_ID","to":"CLIENT_ID"}</code><br>
                                <br>eg : <code class="code">{"msg_type":"testMsg","message":"Hello world","from":"fsock_user1","to":"fsock_user2"}</code>
                    </div>
                </div>
                <br>
                <p class="count_label"><i class="bi bi-eye-fill"></i> <span id="connection_count">0</span></p>
                <button type="button" class="btn btn-success normal_button " id="testWebsite_Ws">Test Websocket</button>
            </div>
        </div>
    </div>

    <!--snof effect div-->
    <div class="snow-container">
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    </div>

    <script>
        const connection_count = document.getElementById("connection_count"); //count displaying element

        //use exact domain for generating url
        const domainWithPort = window.location.host;
        document.querySelectorAll('.domain').forEach(el => {
            el.innerText = domainWithPort;
        });

        //get the count of the users
        async function getCount(){
            try{
                const response = await fetch("/count")
                if(!response.ok){
                    throw new Error(`Response status : ${response.status}`)
                }
                const json = await response.json();
                
                connection_count.innerText = json["no"]
            }catch(e){

            }
        }
        getCount()

        //go to test websocket 
        document.getElementById("testWebsite_Ws").addEventListener('click',()=>{
            window.location.href = "/testws"
        });
    </script>
</body>
</html>